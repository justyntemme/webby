{
  "projectPath": "/Users/justyntemme/Documents/code/webby",
  "stories": [
    {
      "id": "STORY-001",
      "title": "Upload EPUBs to Server",
      "description": "As a user, I want to upload EPUB files to the server so that I can store my ebook collection in one place and access it from any device. The system should validate that uploaded files are valid EPUBs, extract metadata (title, author, series info), and store them securely. Users should receive feedback on upload progress and success/failure status.",
      "acceptanceCriteria": [
        "User can upload EPUB files via API endpoint",
        "System validates uploaded file is a valid EPUB",
        "Metadata (title, author, series) is automatically extracted and stored",
        "Upload returns book ID and extracted metadata on success",
        "Invalid files return appropriate error messages",
        "Files are stored persistently and survive server restart"
      ],
      "tasks": [
        {
          "id": "TASK-001",
          "title": "Set up Go project structure with gin/echo framework",
          "description": "Initialize Go module, set up directory structure (cmd, internal, pkg), and configure web framework",
          "status": "pending"
        },
        {
          "id": "TASK-002",
          "title": "Create EPUB file storage system",
          "description": "Implement file storage for uploaded EPUBs with unique IDs and organized directory structure",
          "status": "pending"
        },
        {
          "id": "TASK-003",
          "title": "Build EPUB metadata parser",
          "description": "Parse EPUB files to extract title, author, series, cover image, and other metadata from OPF file",
          "status": "pending"
        },
        {
          "id": "TASK-004",
          "title": "Create upload API endpoint",
          "description": "POST /api/books endpoint that accepts multipart file uploads, validates EPUB format, extracts metadata, and stores the file",
          "status": "pending"
        },
        {
          "id": "TASK-005",
          "title": "Implement SQLite database for book metadata",
          "description": "Create database schema and repository for storing book metadata (id, title, author, series, file_path, upload_date)",
          "status": "pending"
        },
        {
          "id": "TASK-006",
          "title": "Add upload validation and error handling",
          "description": "Validate file size limits, EPUB format, and return appropriate error responses",
          "status": "pending"
        }
      ],
      "priority": 1,
      "complexity": "medium",
      "status": "completed",
      "createdAt": "2025-12-21T11:35:38-06:00",
      "updatedAt": "2025-12-21T11:35:38-06:00"
    },
    {
      "id": "STORY-002",
      "title": "Move and Organize EPUBs",
      "description": "As a user, I want to organize my EPUB collection into folders/collections so that I can keep my library structured. This includes creating collections, moving books between collections, renaming collections, and deleting empty collections. The organization should persist across sessions and be accessible from any device.",
      "acceptanceCriteria": [
        "User can create named collections",
        "User can move books into collections",
        "User can remove books from collections",
        "User can rename and delete collections",
        "Collections persist across sessions",
        "A book can belong to multiple collections"
      ],
      "tasks": [
        {
          "id": "TASK-007",
          "title": "Create collections database schema",
          "description": "Add collections table and book_collections junction table to support organizing books into collections",
          "status": "pending"
        },
        {
          "id": "TASK-008",
          "title": "Build collection CRUD API endpoints",
          "description": "POST/GET/PUT/DELETE /api/collections endpoints for managing collections",
          "status": "pending"
        },
        {
          "id": "TASK-009",
          "title": "Implement move book to collection endpoint",
          "description": "PUT /api/books/:id/collection endpoint to assign/move books between collections",
          "status": "pending"
        },
        {
          "id": "TASK-010",
          "title": "Add bulk operations for organizing",
          "description": "Support moving multiple books at once and bulk collection assignment",
          "status": "pending"
        }
      ],
      "priority": 4,
      "complexity": "medium",
      "status": "completed",
      "dependencies": [
        "STORY-001"
      ],
      "createdAt": "2025-12-21T11:35:38-06:00",
      "updatedAt": "2025-12-21T11:35:38-06:00"
    },
    {
      "id": "STORY-003",
      "title": "Quick Sort by Author/Series",
      "description": "As a user, I want to quickly sort and filter my EPUB library by author or series so that I can easily find books by a specific author or continue reading a series. The sorting should be fast and responsive, with options to toggle between different sort modes. Series books should display in proper reading order.",
      "acceptanceCriteria": [
        "User can sort library by author, series, title, or upload date",
        "User can toggle ascending/descending order",
        "Books in a series display in proper reading order",
        "User can view books grouped by author",
        "User can view books grouped by series",
        "User can search/filter books by text query"
      ],
      "tasks": [
        {
          "id": "TASK-011",
          "title": "Add sorting query parameters to book list API",
          "description": "Support ?sort=author|series|title|date and ?order=asc|desc on GET /api/books",
          "status": "pending"
        },
        {
          "id": "TASK-012",
          "title": "Implement author grouping endpoint",
          "description": "GET /api/books/by-author returns books grouped by author",
          "status": "pending"
        },
        {
          "id": "TASK-013",
          "title": "Implement series grouping endpoint",
          "description": "GET /api/books/by-series returns books grouped by series with proper reading order",
          "status": "pending"
        },
        {
          "id": "TASK-014",
          "title": "Add search/filter functionality",
          "description": "Support ?search=query parameter for filtering books by title, author, or series",
          "status": "pending"
        }
      ],
      "priority": 3,
      "complexity": "low",
      "status": "completed",
      "dependencies": [
        "STORY-001"
      ],
      "createdAt": "2025-12-21T11:35:39-06:00",
      "updatedAt": "2025-12-21T11:35:39-06:00"
    },
    {
      "id": "STORY-004",
      "title": "Read Rendered EPUB in Browser",
      "description": "As a user, I want to tap on a book in my library to open and read it in a mobile-friendly reader so that I can read my EPUBs directly in the browser without downloading them. The reader should render EPUB content properly, support page navigation, remember reading position, and be optimized for mobile phone screens with touch-friendly controls.",
      "acceptanceCriteria": [
        "Tapping a book opens the reader view",
        "EPUB content renders correctly in browser",
        "User can navigate between chapters",
        "Reading position is saved and restored on return",
        "Reader is responsive and works well on mobile phones",
        "Touch gestures work for page navigation"
      ],
      "tasks": [
        {
          "id": "TASK-015",
          "title": "Create EPUB content extraction API",
          "description": "GET /api/books/:id/content/:chapter endpoint to serve individual chapters as HTML",
          "status": "pending"
        },
        {
          "id": "TASK-016",
          "title": "Build EPUB table of contents API",
          "description": "GET /api/books/:id/toc returns the book's table of contents with chapter links",
          "status": "pending"
        },
        {
          "id": "TASK-017",
          "title": "Implement reading position persistence",
          "description": "POST/GET /api/books/:id/position to save and retrieve last reading position",
          "status": "pending"
        },
        {
          "id": "TASK-018",
          "title": "Serve book cover images",
          "description": "GET /api/books/:id/cover returns the book's cover image",
          "status": "pending"
        },
        {
          "id": "TASK-019",
          "title": "Create static file server for web reader",
          "description": "Serve HTML/CSS/JS for the mobile-friendly EPUB reader frontend",
          "status": "pending"
        },
        {
          "id": "TASK-020",
          "title": "Build mobile-friendly reader UI",
          "description": "Create responsive HTML/CSS/JS reader with touch navigation, font sizing, and chapter selection",
          "status": "pending"
        }
      ],
      "priority": 2,
      "complexity": "high",
      "status": "completed",
      "dependencies": [
        "STORY-001"
      ],
      "createdAt": "2025-12-21T11:35:39-06:00",
      "updatedAt": "2025-12-21T11:35:39-06:00"
    },
    {
      "id": "STORY-005",
      "title": "User Authentication",
      "description": "As a user, I want to register and login to the application so that my library is private and secure. Use well-established authentication libraries (like bcrypt for password hashing, JWT for sessions) rather than custom crypto implementations. Support basic registration, login, logout, and session management.",
      "tasks": [
        {
          "id": "TASK-021",
          "title": "Add User model and database schema",
          "description": "Create users table with id, username, email, password_hash, created_at fields",
          "status": "pending"
        },
        {
          "id": "TASK-022",
          "title": "Implement password hashing with bcrypt",
          "description": "Use golang.org/x/crypto/bcrypt for secure password hashing",
          "status": "pending"
        },
        {
          "id": "TASK-023",
          "title": "Create registration endpoint",
          "description": "POST /api/auth/register for new user signup with validation",
          "status": "pending"
        },
        {
          "id": "TASK-024",
          "title": "Create login endpoint with JWT",
          "description": "POST /api/auth/login returns JWT token on successful auth",
          "status": "pending"
        },
        {
          "id": "TASK-025",
          "title": "Implement JWT middleware",
          "description": "Middleware to validate JWT tokens and extract user context",
          "status": "pending"
        },
        {
          "id": "TASK-026",
          "title": "Add logout and token refresh",
          "description": "POST /api/auth/logout and token refresh mechanisms",
          "status": "pending"
        }
      ],
      "priority": 2,
      "complexity": "medium",
      "status": "completed",
      "createdAt": "2025-12-21T11:54:26-06:00",
      "updatedAt": "2025-12-21T11:54:26-06:00"
    },
    {
      "id": "STORY-006",
      "title": "User-Based Libraries",
      "description": "As a user, I want my own private library with a separate storage folder so that my books are isolated from other users. Each user should have their own books directory, and all book operations (upload, list, read, organize) should be scoped to the authenticated user's library.",
      "tasks": [
        {
          "id": "TASK-027",
          "title": "Add user_id foreign key to books table",
          "description": "Migrate database to associate books with users",
          "status": "pending"
        },
        {
          "id": "TASK-028",
          "title": "Create per-user storage directories",
          "description": "Organize file storage as data/users/{user_id}/books/",
          "status": "pending"
        },
        {
          "id": "TASK-029",
          "title": "Update all book endpoints to scope by user",
          "description": "Filter all book queries by authenticated user's ID",
          "status": "pending"
        },
        {
          "id": "TASK-030",
          "title": "Update collections to be user-scoped",
          "description": "Add user_id to collections and filter accordingly",
          "status": "pending"
        }
      ],
      "priority": 3,
      "complexity": "medium",
      "status": "completed",
      "dependencies": [
        "STORY-005"
      ],
      "createdAt": "2025-12-21T11:54:26-06:00",
      "updatedAt": "2025-12-21T11:54:26-06:00"
    },
    {
      "id": "STORY-007",
      "title": "Book Sharing Between Users",
      "description": "As a user, I want to share specific books with other users so they can read books from my library. Implement sharing via metadata (allowed_users field on books) rather than symlinks. Users should be able to share/unshare books and see books shared with them in a separate \"Shared with me\" view.",
      "tasks": [
        {
          "id": "TASK-031",
          "title": "Create book_shares table",
          "description": "Table with book_id, owner_id, shared_with_user_id, created_at",
          "status": "pending"
        },
        {
          "id": "TASK-032",
          "title": "Add share/unshare book endpoints",
          "description": "POST/DELETE /api/books/:id/share/:userId",
          "status": "pending"
        },
        {
          "id": "TASK-033",
          "title": "Create shared books list endpoint",
          "description": "GET /api/books/shared returns books shared with current user",
          "status": "pending"
        },
        {
          "id": "TASK-034",
          "title": "Update book access to check sharing permissions",
          "description": "Allow reading books if owner OR shared with user",
          "status": "pending"
        }
      ],
      "priority": 4,
      "complexity": "medium",
      "status": "completed",
      "dependencies": [
        "STORY-006"
      ],
      "createdAt": "2025-12-21T11:54:26-06:00",
      "updatedAt": "2025-12-21T11:54:26-06:00"
    },
    {
      "id": "STORY-008",
      "title": "Reader Navigation Improvement",
      "description": "As a user, when reading a book I want a clear way to navigate back to my library so I don't feel trapped in the reader. Add a visible \"Back to Library\" button/link in the reader header that returns to the main library view.",
      "tasks": [
        {
          "id": "TASK-035",
          "title": "Add back to library button in reader header",
          "description": "Add home/back icon button that navigates to / in reader.html",
          "status": "pending"
        }
      ],
      "priority": 1,
      "complexity": "low",
      "status": "completed",
      "createdAt": "2025-12-21T11:54:26-06:00",
      "updatedAt": "2025-12-21T11:54:26-06:00"
    },
    {
      "id": "STORY-009",
      "title": "Unit Test Coverage",
      "description": "As a developer, I want comprehensive unit tests for all API endpoints and core business logic so that the codebase is reliable and regressions are caught early. Cover database operations, EPUB parsing, API handlers, and authentication flows.",
      "tasks": [
        {
          "id": "TASK-036",
          "title": "Set up testing framework",
          "description": "Configure Go testing with testify assertions",
          "status": "pending"
        },
        {
          "id": "TASK-037",
          "title": "Write database layer tests",
          "description": "Test all CRUD operations for books, users, collections",
          "status": "pending"
        },
        {
          "id": "TASK-038",
          "title": "Write EPUB parser tests",
          "description": "Test metadata extraction and validation",
          "status": "pending"
        },
        {
          "id": "TASK-039",
          "title": "Write API handler tests",
          "description": "HTTP tests for all endpoints with mock data",
          "status": "pending"
        },
        {
          "id": "TASK-040",
          "title": "Write auth middleware tests",
          "description": "Test JWT validation and user context extraction",
          "status": "pending"
        }
      ],
      "priority": 5,
      "complexity": "medium",
      "status": "completed",
      "dependencies": [
        "STORY-005"
      ],
      "createdAt": "2025-12-21T11:54:26-06:00",
      "updatedAt": "2025-12-21T11:54:26-06:00"
    },
    {
      "id": "STORY-010",
      "title": "TUI Client API Support",
      "description": "As a TUI client developer, I want the API to return clean JSON responses suitable for terminal display. The API already returns JSON, but ensure consistent response format, proper error codes, and no HTML/markup in data fields. Support pagination for large lists and provide endpoints optimized for terminal workflows.",
      "tasks": [
        {
          "id": "TASK-041",
          "title": "Add pagination to book list endpoints",
          "description": "Support ?page=N\u0026limit=N query parameters on GET /api/books",
          "status": "pending"
        },
        {
          "id": "TASK-042",
          "title": "Add plain text chapter endpoint",
          "description": "GET /api/books/:id/content/:chapter/text returns stripped HTML as plain text",
          "status": "pending"
        },
        {
          "id": "TASK-043",
          "title": "Add API documentation endpoint",
          "description": "GET /api returns list of available endpoints for TUI discovery",
          "status": "pending"
        }
      ],
      "priority": 1,
      "complexity": "low",
      "status": "completed",
      "createdAt": "2025-12-21T12:05:54-06:00",
      "updatedAt": "2025-12-21T12:05:54-06:00"
    },
    {
      "id": "STORY-011",
      "title": "Reading Position Sync (Bookmarks)",
      "description": "As a user, I want my reading position to be saved automatically when I exit a book, so that I can resume reading from the same spot on any device (laptop, phone, etc.). This feature should persist the reading position to the backend so it syncs across all my devices.",
      "acceptanceCriteria": [
        "Reading position is saved per-user in the database (using user_id in reading_positions table)",
        "When user exits a book (back button, page close, or chapter change), position is saved to backend",
        "When user opens a book, their saved position is fetched from backend and reader resumes at that chapter",
        "Reading position syncs across devices - reading on laptop saves position, opening on phone resumes from same spot",
        "Position includes both chapter index and scroll position within chapter",
        "Frontend passes authentication token when saving/loading positions",
        "Unauthenticated users can still save positions (using empty user_id, local-only)"
      ],
      "tasks": [
        {
          "id": "TASK-044",
          "title": "Fix database layer to use user_id in reading positions",
          "description": "Update SaveReadingPosition to include user_id in INSERT and ON CONFLICT clause. Update GetReadingPosition to accept userID parameter and filter by both book_id and user_id.",
          "status": "pending"
        },
        {
          "id": "TASK-045",
          "title": "Update API handlers to pass user context to reading position operations",
          "description": "Modify GetReadingPosition and SaveReadingPosition handlers to extract user_id from auth context and pass it to database methods.",
          "status": "pending"
        },
        {
          "id": "TASK-046",
          "title": "Update frontend to include auth token in position API calls",
          "description": "Modify reader.html to store/retrieve JWT token and include Authorization header when calling /api/books/:id/position endpoints.",
          "status": "pending"
        },
        {
          "id": "TASK-047",
          "title": "Add scroll position restoration on chapter load",
          "description": "When loading saved position, also restore scroll position within the chapter (not just chapter index).",
          "status": "pending"
        },
        {
          "id": "TASK-048",
          "title": "Write tests for user-scoped reading positions",
          "description": "Add unit tests to verify positions are correctly scoped per-user and sync works across simulated devices.",
          "status": "pending"
        }
      ],
      "priority": 1,
      "complexity": "medium",
      "status": "completed",
      "createdAt": "2025-12-21T12:46:27-06:00",
      "updatedAt": "2025-12-21T12:46:27-06:00"
    },
    {
      "id": "STORY-012",
      "title": "User Authentication System",
      "description": "As a user, I want to be required to sign up and log in before accessing the application, so that my data is secure and I have a personalized experience. Currently, navigating to / assumes a user is created and anyone can access the default user's data without authentication.",
      "acceptanceCriteria": [
        "Login page with username/email and password fields",
        "Registration page with username, email, and password fields with validation",
        "Use industry-standard secure auth library (bcrypt for passwords, JWT for tokens)",
        "Auth middleware properly validates JWT tokens on protected routes",
        "JWT tokens stored securely in localStorage with proper expiry handling",
        "Password requirements enforced (minimum 8 characters)",
        "Error handling for invalid credentials and duplicate users",
        "Do NOT force login until auth pages are complete and tested",
        "Logout functionality that clears tokens"
      ],
      "tasks": [
        {
          "id": "TASK-049",
          "title": "Create login/signup frontend page",
          "description": "Build auth.html with forms for login and registration, including validation and error handling.",
          "status": "pending"
        },
        {
          "id": "TASK-050",
          "title": "Add auth state management to frontend",
          "description": "Store JWT token in localStorage, add helper functions for checking auth state and including token in requests.",
          "status": "pending"
        },
        {
          "id": "TASK-051",
          "title": "Implement auth redirect logic on index page",
          "description": "Check for valid JWT on page load, redirect to auth page if missing or expired.",
          "status": "pending"
        },
        {
          "id": "TASK-052",
          "title": "Add logout functionality",
          "description": "Add logout button to library UI that clears JWT and redirects to auth page.",
          "status": "pending"
        },
        {
          "id": "TASK-053",
          "title": "Update all API calls to include auth headers",
          "description": "Modify fetch calls throughout frontend to include Authorization: Bearer token header.",
          "status": "pending"
        }
      ],
      "priority": 2,
      "complexity": "high",
      "status": "completed",
      "createdAt": "2025-12-21T12:46:27-06:00",
      "updatedAt": "2025-12-21T12:46:27-06:00"
    },
    {
      "id": "STORY-013",
      "title": "Add --url flag for custom server URL",
      "description": "As a user, I want to pass a --url flag to the application that specifies a custom URL/endpoint for the server to bind to. This allows configuring the server address at runtime instead of using a default.",
      "tasks": [
        {
          "id": "TASK-054",
          "title": "Add --url flag parsing to main.go",
          "description": "Add command-line flag parsing using Go's flag package to accept a --url parameter for the server bind address.",
          "status": "pending"
        },
        {
          "id": "TASK-055",
          "title": "Update server startup to use the URL flag",
          "description": "Modify the gin router startup to bind to the address specified by the --url flag instead of just the port.",
          "status": "pending"
        }
      ],
      "priority": 1,
      "complexity": "low",
      "status": "completed",
      "createdAt": "2025-12-21T14:15:32-06:00",
      "updatedAt": "2025-12-21T14:15:32-06:00"
    },
    {
      "id": "STORY-014",
      "title": "Add flag to disable account registration",
      "description": "As an administrator, I want a command-line flag or environment variable to disable new account registration, so that I can run a private instance where only existing users can log in. This is useful for personal/family deployments where you don't want random signups.",
      "tasks": [
        {
          "id": "TASK-056",
          "title": "Add --disable-registration flag and env var",
          "description": "Add command-line flag and WEBBY_DISABLE_REGISTRATION env var to main.go",
          "status": "pending"
        },
        {
          "id": "TASK-057",
          "title": "Pass registration setting to auth handler",
          "description": "Update auth handler to check if registration is disabled and return appropriate error",
          "status": "pending"
        },
        {
          "id": "TASK-058",
          "title": "Update auth UI to hide registration when disabled",
          "description": "Add API endpoint to check registration status and hide signup tab if disabled",
          "status": "pending"
        }
      ],
      "priority": 1,
      "complexity": "low",
      "status": "completed",
      "createdAt": "2025-12-21T14:24:29-06:00",
      "updatedAt": "2025-12-21T14:24:29-06:00"
    },
    {
      "id": "STORY-015",
      "title": "Document Docker database volume mounting",
      "description": "As a user deploying with Docker, I want clear documentation in the Dockerfile showing where the database is stored and how to mount a volume for persistent data, so that I can easily configure data persistence in my docker run command.",
      "tasks": [
        {
          "id": "TASK-059",
          "title": "Add comments to Dockerfile for data volume",
          "description": "Add clear comments showing where data is stored and example volume mount commands",
          "status": "pending"
        },
        {
          "id": "TASK-060",
          "title": "Create README section for Docker deployment",
          "description": "Document Docker usage with volume mounting examples in README or docs",
          "status": "pending"
        }
      ],
      "priority": 1,
      "complexity": "low",
      "status": "completed",
      "createdAt": "2025-12-21T14:24:29-06:00",
      "updatedAt": "2025-12-21T14:24:29-06:00"
    },
    {
      "id": "STORY-016",
      "title": "Require authentication to access library",
      "description": "Remove the 'Continue without signing in' option and require users to authenticate before accessing the library. Redirect unauthenticated users to the login page.",
      "priority": 1,
      "complexity": "low",
      "status": "completed",
      "createdAt": "2025-12-21T14:33:02-06:00",
      "updatedAt": "2025-12-21T14:33:02-06:00"
    },
    {
      "id": "STORY-017",
      "title": "Fix sorting by author showing blank results",
      "description": "As a user, when I sort by author, the library shows blank/empty results. This is a bug that needs investigation - likely related to how books without author metadata are handled or how the grouping query works.",
      "acceptanceCriteria": [
        "Sorting by author displays all books that have author metadata",
        "Books without author metadata are displayed at the end of the list (or in a separate 'Unknown Author' group)",
        "Author sort is case-insensitive for consistent ordering",
        "Author names display correctly in the book cards when sorted",
        "No blank/empty results when author field exists in EPUB metadata"
      ],
      "tasks": [
        {
          "id": "TASK-061",
          "title": "Investigate author sorting bug",
          "description": "Debug the frontend sorting logic and API response to identify why author sort returns blank. Check if author field is being extracted from EPUB metadata and stored in database correctly.",
          "status": "pending"
        },
        {
          "id": "TASK-062",
          "title": "Fix author field extraction from EPUB",
          "description": "Ensure the EPUB parser correctly extracts the dc:creator field and stores it in the books table author column.",
          "status": "pending"
        },
        {
          "id": "TASK-063",
          "title": "Update frontend sorting logic",
          "description": "Fix the JavaScript sorting function to properly handle books with missing author data and sort alphabetically by author name.",
          "status": "pending"
        },
        {
          "id": "TASK-064",
          "title": "Add tests for author sorting",
          "description": "Write unit tests to verify author extraction and sorting behavior with various EPUB files.",
          "status": "pending"
        }
      ],
      "priority": 3,
      "complexity": "low",
      "status": "completed",
      "dependencies": [
        "STORY-021"
      ],
      "createdAt": "2025-12-21T15:26:56-06:00",
      "updatedAt": "2025-12-21T15:26:56-06:00"
    },
    {
      "id": "STORY-018",
      "title": "Automatic metadata lookup for books",
      "description": "As a user, I want the system to automatically look up and fill in missing metadata (title, author, series, cover) for my uploaded books using external data sources like Google Books API, Open Library, or Goodreads. This ensures books can be properly sorted and organized even if the EPUB has incomplete metadata.",
      "acceptanceCriteria": [
        "System can lookup book metadata using ISBN, title, and/or author from Open Library API",
        "Lookup returns: title, author(s), description, cover image URL, publish date, publisher, series info",
        "Automatic lookup triggers on book upload when EPUB metadata is incomplete",
        "User can manually trigger lookup for any book from the UI",
        "API rate limiting is implemented to avoid being blocked by metadata providers",
        "Fallback logic tries multiple search strategies (ISBN first, then title+author, then title only)",
        "Metadata confidence score indicates match quality to user",
        "Failed lookups are logged and don't crash the application"
      ],
      "tasks": [
        {
          "id": "TASK-065",
          "title": "Research and select metadata API providers",
          "description": "Evaluate Open Library, Google Books, and other free metadata APIs. Document rate limits, data quality, and required authentication. Select primary and fallback providers.",
          "status": "pending"
        },
        {
          "id": "TASK-066",
          "title": "Create metadata provider interface",
          "description": "Design Go interface for metadata providers to allow swapping between different APIs. Include methods for search by ISBN, title, author, and combined searches.",
          "status": "pending"
        },
        {
          "id": "TASK-067",
          "title": "Implement Open Library API client",
          "description": "Build HTTP client for Open Library API with search, ISBN lookup, and cover image retrieval. Handle rate limiting with exponential backoff.",
          "status": "pending"
        },
        {
          "id": "TASK-068",
          "title": "Add metadata matching algorithm",
          "description": "Create fuzzy matching logic to compare API results with existing book data. Calculate confidence score based on title similarity, author match, and other factors.",
          "status": "pending"
        },
        {
          "id": "TASK-069",
          "title": "Integrate lookup into book upload flow",
          "description": "Trigger automatic metadata lookup when a book is uploaded and has missing fields. Run asynchronously to not block upload response.",
          "status": "pending"
        },
        {
          "id": "TASK-070",
          "title": "Add manual lookup trigger endpoint",
          "description": "Create API endpoint POST /api/books/:id/lookup-metadata that triggers metadata search for a specific book and returns results.",
          "status": "pending"
        },
        {
          "id": "TASK-071",
          "title": "Build metadata preview UI",
          "description": "Create frontend component showing metadata search results with confidence scores. Allow user to accept/reject suggested metadata before applying.",
          "status": "pending"
        },
        {
          "id": "TASK-072",
          "title": "Add database fields for metadata source",
          "description": "Track where metadata came from (epub, open_library, manual) and last lookup timestamp in books table.",
          "status": "pending"
        },
        {
          "id": "TASK-073",
          "title": "Write integration tests for metadata lookup",
          "description": "Test API client, matching algorithm, and end-to-end lookup flow with mocked HTTP responses.",
          "status": "pending"
        }
      ],
      "priority": 4,
      "complexity": "high",
      "status": "ready",
      "dependencies": [
        "STORY-017",
        "STORY-024"
      ],
      "createdAt": "2025-12-21T15:26:56-06:00",
      "updatedAt": "2025-12-21T15:26:56-06:00"
    },
    {
      "id": "STORY-019",
      "title": "Manual metadata editing for books",
      "description": "As a user, I want to manually edit book metadata (title, author, series, series index) through the web UI when automatic lookup fails or returns incorrect data. This gives users control over how their books are organized.",
      "acceptanceCriteria": [
        "User can edit book metadata fields: title, author, description, series, series index, publisher, publish date",
        "Edit form is accessible from book detail view via 'Edit Metadata' button",
        "Changes are validated before saving (e.g., series index must be numeric)",
        "Original EPUB file is not modified - metadata stored only in database",
        "User can upload a custom cover image to replace extracted cover",
        "Edit history is preserved showing when metadata was last modified",
        "Cancel button discards unsaved changes with confirmation if edits were made"
      ],
      "tasks": [
        {
          "id": "TASK-074",
          "title": "Add metadata edit API endpoint",
          "description": "Create PUT /api/books/:id/metadata endpoint that accepts JSON body with editable fields. Validate input and update books table.",
          "status": "pending"
        },
        {
          "id": "TASK-075",
          "title": "Extend book model with editable fields",
          "description": "Add series, series_index, publisher, publish_date, description fields to books table if not present. Add updated_at timestamp.",
          "status": "pending"
        },
        {
          "id": "TASK-076",
          "title": "Build metadata edit modal/form UI",
          "description": "Create form component with fields for all editable metadata. Include validation feedback and save/cancel buttons.",
          "status": "pending"
        },
        {
          "id": "TASK-077",
          "title": "Add custom cover upload endpoint",
          "description": "Create POST /api/books/:id/cover endpoint to upload custom cover image. Store in covers directory and update book record.",
          "status": "pending"
        },
        {
          "id": "TASK-078",
          "title": "Integrate edit button in book detail view",
          "description": "Add 'Edit Metadata' button to book card or detail view. Open edit modal when clicked with current values pre-filled.",
          "status": "pending"
        },
        {
          "id": "TASK-079",
          "title": "Write tests for metadata editing",
          "description": "Test API endpoint validation, database updates, and cover upload functionality.",
          "status": "pending"
        }
      ],
      "priority": 5,
      "complexity": "medium",
      "status": "ready",
      "dependencies": [
        "STORY-017",
        "STORY-024"
      ],
      "createdAt": "2025-12-21T15:26:56-06:00",
      "updatedAt": "2025-12-21T15:26:56-06:00"
    },
    {
      "id": "STORY-020",
      "title": "Bulk metadata refresh for library",
      "description": "As a user, I want to trigger a bulk metadata refresh for all books in my library that have missing or incomplete information, so I don't have to update each book individually.",
      "acceptanceCriteria": [
        "User can trigger bulk metadata refresh for all books or selected books",
        "Progress indicator shows current book being processed and overall progress",
        "Bulk operation runs in background without blocking UI",
        "User can cancel bulk operation mid-process",
        "Results summary shows: books updated, books skipped (already complete), books failed",
        "Rate limiting prevents API abuse during bulk operations",
        "Only books with incomplete metadata are processed by default (option to force refresh all)"
      ],
      "tasks": [
        {
          "id": "TASK-080",
          "title": "Create bulk refresh API endpoint",
          "description": "Create POST /api/books/bulk-refresh endpoint that accepts list of book IDs or 'all' flag. Returns job ID for progress tracking.",
          "status": "pending"
        },
        {
          "id": "TASK-081",
          "title": "Implement background job queue",
          "description": "Build simple in-memory job queue for processing bulk operations. Track job status, progress, and allow cancellation.",
          "status": "pending"
        },
        {
          "id": "TASK-082",
          "title": "Add job status endpoint",
          "description": "Create GET /api/jobs/:id endpoint to check bulk operation progress, current item, and results.",
          "status": "pending"
        },
        {
          "id": "TASK-083",
          "title": "Build bulk refresh UI controls",
          "description": "Add 'Refresh All Metadata' button to library view. Show progress modal with current book, percentage, and cancel button.",
          "status": "pending"
        },
        {
          "id": "TASK-084",
          "title": "Add selection mode for bulk operations",
          "description": "Allow user to select multiple books and trigger refresh for selection only. Add checkboxes to book cards.",
          "status": "pending"
        },
        {
          "id": "TASK-085",
          "title": "Implement rate-limited batch processing",
          "description": "Process books with configurable delay between API calls. Default 1 second between lookups to respect API limits.",
          "status": "pending"
        },
        {
          "id": "TASK-086",
          "title": "Write tests for bulk operations",
          "description": "Test job queue, progress tracking, cancellation, and rate limiting behavior.",
          "status": "pending"
        }
      ],
      "priority": 6,
      "complexity": "medium",
      "status": "ready",
      "dependencies": [
        "STORY-018"
      ],
      "createdAt": "2025-12-21T15:26:56-06:00",
      "updatedAt": "2025-12-21T15:26:56-06:00"
    },
    {
      "id": "STORY-021",
      "title": "Research: Investigate author sorting bug",
      "description": "Research and document the root cause of the author sorting bug. Analyze how EPUB metadata is currently extracted, stored in the database, and used by the frontend sorting logic. Document findings before implementing any fixes.",
      "acceptanceCriteria": [
        "Root cause of blank author sorting is identified and documented",
        "Current EPUB parser author extraction logic is analyzed",
        "Database schema for author field is documented",
        "Frontend sorting logic for authors is analyzed",
        "Findings documented in .controlflow/research/author-sorting-bug.md"
      ],
      "tasks": [
        {
          "id": "TASK-087",
          "title": "Trace EPUB author extraction code path",
          "description": "Read internal/epub/parser.go and trace how dc:creator is extracted from EPUB files. Document the extraction logic.",
          "status": "pending"
        },
        {
          "id": "TASK-088",
          "title": "Analyze database author storage",
          "description": "Check books table schema and how author field is populated during upload. Query existing books to see author data state.",
          "status": "pending"
        },
        {
          "id": "TASK-089",
          "title": "Debug frontend author sorting",
          "description": "Analyze index.html JavaScript sorting logic. Identify why author sort returns blank - is it API, data, or display issue?",
          "status": "pending"
        },
        {
          "id": "TASK-090",
          "title": "Document findings in research file",
          "description": "Create .controlflow/research/author-sorting-bug.md with root cause analysis and recommended fix approach.",
          "status": "pending"
        }
      ],
      "priority": 1,
      "complexity": "low",
      "status": "completed",
      "createdAt": "2025-12-21T16:02:35-06:00",
      "updatedAt": "2025-12-21T16:02:35-06:00"
    },
    {
      "id": "STORY-022",
      "title": "Research: Evaluate metadata API providers",
      "description": "Research and evaluate free metadata API providers for book information lookup. Compare Open Library, Google Books API, and other options. Document rate limits, data quality, authentication requirements, and available fields. Recommend primary and fallback providers.",
      "acceptanceCriteria": [
        "Open Library API capabilities and limits documented",
        "Google Books API capabilities and limits documented",
        "At least one additional alternative API evaluated",
        "Comparison matrix created with: rate limits, auth requirements, data fields, reliability",
        "Primary and fallback provider recommendations made",
        "Findings documented in .controlflow/research/metadata-api-providers.md"
      ],
      "tasks": [
        {
          "id": "TASK-091",
          "title": "Research Open Library API",
          "description": "Document Open Library search API, ISBN lookup, covers API. Note rate limits, authentication, response format, and available fields.",
          "status": "pending"
        },
        {
          "id": "TASK-092",
          "title": "Research Google Books API",
          "description": "Document Google Books API capabilities, API key requirements, quota limits, and data quality compared to Open Library.",
          "status": "pending"
        },
        {
          "id": "TASK-093",
          "title": "Research alternative APIs",
          "description": "Evaluate alternatives: Goodreads (if available), ISBNdb, LibraryThing, or others. Note any that are free and suitable.",
          "status": "pending"
        },
        {
          "id": "TASK-094",
          "title": "Create comparison matrix",
          "description": "Build comparison table of all evaluated APIs with: rate limits, auth, fields available, reliability, terms of service.",
          "status": "pending"
        },
        {
          "id": "TASK-095",
          "title": "Write recommendation document",
          "description": "Create .controlflow/research/metadata-api-providers.md with findings and primary/fallback provider recommendations.",
          "status": "pending"
        }
      ],
      "priority": 1,
      "complexity": "medium",
      "status": "completed",
      "createdAt": "2025-12-21T16:02:35-06:00",
      "updatedAt": "2025-12-21T16:02:35-06:00"
    },
    {
      "id": "STORY-023",
      "title": "Research: Analyze current EPUB metadata extraction",
      "description": "Document the current EPUB parsing implementation. Identify which metadata fields are extracted (title, author, description, ISBN, etc.), how they're stored in the database, and what fields are missing or incomplete. Create a gap analysis for metadata enhancement.",
      "acceptanceCriteria": [
        "All currently extracted EPUB metadata fields documented",
        "Database books table schema fully documented",
        "Gap analysis: fields available in EPUB vs fields we extract",
        "Gap analysis: fields we need vs fields we have",
        "List of missing fields that need external lookup",
        "Findings documented in .controlflow/research/epub-metadata-analysis.md"
      ],
      "tasks": [
        {
          "id": "TASK-096",
          "title": "Document EPUB parser implementation",
          "description": "Read internal/epub/parser.go and document all metadata fields currently extracted: title, author, description, cover, etc.",
          "status": "pending"
        },
        {
          "id": "TASK-097",
          "title": "Document database schema",
          "description": "Analyze internal/storage/database.go schema creation. Document all columns in books table and their purposes.",
          "status": "pending"
        },
        {
          "id": "TASK-098",
          "title": "Analyze sample EPUBs for available metadata",
          "description": "Examine OPF files in sample EPUBs to identify what metadata fields are typically available (ISBN, publisher, series, etc.).",
          "status": "pending"
        },
        {
          "id": "TASK-099",
          "title": "Create metadata gap analysis",
          "description": "Create .controlflow/research/epub-metadata-analysis.md documenting current state and gaps that need external lookup.",
          "status": "pending"
        }
      ],
      "priority": 1,
      "complexity": "low",
      "status": "completed",
      "createdAt": "2025-12-21T16:02:36-06:00",
      "updatedAt": "2025-12-21T16:02:36-06:00"
    },
    {
      "id": "STORY-024",
      "title": "Research: Design metadata system architecture",
      "description": "Based on research findings, design the architecture for the metadata lookup system. Define interfaces, data flow, database schema changes, and API contracts. Create technical design document before implementation begins.",
      "acceptanceCriteria": [
        "Go interface design for metadata providers documented",
        "Database schema changes required are specified",
        "API endpoint contracts defined (request/response formats)",
        "Data flow diagram from upload to metadata enrichment",
        "Error handling and retry strategy defined",
        "Technical design documented in .controlflow/research/metadata-system-design.md"
      ],
      "tasks": [
        {
          "id": "TASK-100",
          "title": "Design metadata provider interface",
          "description": "Define Go interface for metadata providers with methods for search, ISBN lookup, and cover retrieval. Document in design doc.",
          "status": "pending"
        },
        {
          "id": "TASK-101",
          "title": "Design database schema changes",
          "description": "Specify new columns needed: series, series_index, publisher, publish_date, isbn, metadata_source, metadata_updated_at.",
          "status": "pending"
        },
        {
          "id": "TASK-102",
          "title": "Define API contracts",
          "description": "Document new endpoints: POST /api/books/:id/lookup-metadata, PUT /api/books/:id/metadata, POST /api/books/:id/cover.",
          "status": "pending"
        },
        {
          "id": "TASK-103",
          "title": "Create data flow diagram",
          "description": "Document the flow: upload -\u003e extract EPUB metadata -\u003e check completeness -\u003e trigger lookup -\u003e preview -\u003e apply.",
          "status": "pending"
        },
        {
          "id": "TASK-104",
          "title": "Write technical design document",
          "description": "Create .controlflow/research/metadata-system-design.md consolidating all architecture decisions.",
          "status": "pending"
        }
      ],
      "priority": 2,
      "complexity": "medium",
      "status": "completed",
      "dependencies": [
        "STORY-021",
        "STORY-022",
        "STORY-023"
      ],
      "createdAt": "2025-12-21T16:02:36-06:00",
      "updatedAt": "2025-12-21T16:02:36-06:00"
    }
  ],
  "lastUpdated": "2025-12-21T16:27:47-06:00",
  "nextStoryId": 25,
  "nextTaskId": 105
}